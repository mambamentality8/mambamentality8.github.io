---
title: 逆向分析(二)----硬编码寻找序列号
top: 1110
tags: []
date: 2019-03-09 23:11:21
permalink:
categories: windows逆向
image:


---

<p class="description"></p>
<meta name="referrer" content="no-referrer" />

<img src="http://blog-mamba.oss-cn-beijing.aliyuncs.com/springboot/title.png">

<!-- more -->

### 逆向分析(二)----硬编码寻找序列号

- 硬编码寻找序列号(一)

  - 首先要会用这个软件
  - 导入OD

  ![1566962956072](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566962956072.png)

  - 使用智能搜索
  - 一般英文的话ASCII居多
  - 中文或者韩文UNICEODE居多
  - 如果不知道的话就用智能搜索

  ![1566963103038](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566963103038.png)

  ![1566963242050](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566963242050.png)

  在MessageBoxA函数和GetDlgItemTextA函数都打上断点

  运行这个程序,此时就在GetDlgItemTextA获取文本框的内容的时候断下来了

  ![1566963385148](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566963385148.png)

  ![1566963586493](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566963586493.png)

  找到Buffer参数   buffer参数指的是你在编辑框中输入的值所存放的地方

  ![1566963664992](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566963664992.png)

  在数据窗口中去跟随个值

  ![1566967316368](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566967316368.png)

  然后在调试中使用执行到返回,就是将这个GetDlgItemTextA这个函数执行到return的地方

  ![1566967605679](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566967605679.png)

  拿到了我编辑框中的值

  ![1566967906929](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566967906929.png)

  此时将403010地址的数值存放到这个ebx中存放的是四个1

  ![1566968257043](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566968257043.png)

  然后将地址00403008里面的数据和ebx里面的数据进行一个比较

  ![1566968762987](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566968762987.png)

  此时Z标志位不是1  也就说明ebx的值和[403008]的值不同    然后je就不发生跳转一直往下走  

  然后就弹窗注册码不正确

  ![1566969402944](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566969402944.png)

  这样的话注册码就正确

  ![1566969471459](C:\Users\85896\AppData\Roaming\Typora\typora-user-images\1566969471459.png)

  其实还可以根据字符串直接分析这里,但是不推荐为什么呢?

  防止作者故意埋下陷阱以致中招





- 硬编码寻找序列号(二)
  - ctrl+n   查看函数列表
  - 找到GetDlgItemTextA函数
  - 在此函数上设置切换断点
  - F9运行
  - 输入6个1   点击验证
  - 在堆栈数据窗口中找到GetDlgItemTextA函数的参数Buffer,然后在数据窗口中跟随
  - 在数据窗口中跟随的数据是数值列的一个数据0040300C
  - 如果不想在隧站窗口中进行跟随的话,也可以在HEX数据窗口中右键---->转到0040300C
  - 然后我们在上面的调试窗口中,选择执行到返回,将这个GetDlgItemTextA函数执行完毕
  - 然后我们F8再运行一步

